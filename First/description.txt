this version adds resend pool function,but speed is bad and the memory it uses when running is large 