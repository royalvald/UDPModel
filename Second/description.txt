this version use stream to transfer.it reduce the volume of memory when it runs